#  Copyright (c) 2024. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
#  Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
#  Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
#  Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
#  Vestibulum commodo. Ut rhoncus gravida arcu.
import matplotlib.pyplot as plt
import numpy as np
from sympy.printing.pretty.pretty_symbology import line_width

loss_1 = np.zeros((5, 2400))
loss_1[0] =
loss_1[1] =
loss_1[2] =
loss_1[3] =
loss_1[4] =

loss_2 = np.zeros((5, 2400))
loss_2[0] =
loss_2[1] =
loss_2[2] =
loss_2[3] =
loss_2[4] =

loss_40 = np.zeros((5, 2400))
loss_40[0] =
loss_40[1] =
loss_40[2] =
loss_40[3] =
loss_40[4] =

loss_80 = np.zeros((5, 2400))
loss_80[0] =
loss_80[1] =
loss_80[2] =
loss_80[3] =
loss_80[4] =

loss_160 = np.zeros((5, 2400))
loss_160[0] =
loss_160[1] =
loss_160[2] =
loss_160[3] =
loss_160[4] =

loss_320 = np.zeros((5, 2400))
loss_320[0] =
loss_320[1] =
loss_320[2] =
loss_320[3] =
loss_320[4] =

theta_10 = np.zeros((5, 10))
theta_10[0] =
theta_10[1] =
theta_10[2] =
theta_10[3] =
theta_10[4] =
#
theta_20 = np.zeros((5, 20))
theta_20[0] =
theta_20[1] =
theta_20[2] =
theta_20[3] =
theta_20[4] =

theta_40 = np.zeros((5, 40))
theta_40[0] =
theta_40[1] =
theta_40[2] =
theta_40[3] =
theta_40[4] =

theta_80 = np.zeros((5, 80))
theta_80[0] =
theta_80[1] =
theta_80[2] =
theta_80[3] =
theta_80[4] =

theta_160 = np.zeros((5, 160))
theta_160[0] =
theta_160[1] =
theta_160[2] =
theta_160[3] =
theta_160[4] =

theta_320 = np.zeros((5, 320))
theta_320[0] =
theta_320[1] =
theta_320[2] =
theta_320[3] =
theta_320[4] =

gamma_10 = np.zeros((5, 10))
gamma_10[0] =
gamma_10[1] =
gamma_10[2] =
gamma_10[3] =
gamma_10[4] =
#
gamma_20 = np.zeros((5, 20))
gamma_20[0] =
gamma_20[2] =
gamma_20[1] =
gamma_20[4] =
gamma_20[3] =

gamma_40 = np.zeros((5, 40))
gamma_40[0] =
gamma_40[1] =
gamma_40[2] =
gamma_40[3] =
gamma_40[4] =

gamma_80 = np.zeros((5, 80))
gamma_80[0] =
gamma_80[1] =
gamma_80[2] =
gamma_80[3] =
gamma_80[4] =

gamma_160 = np.zeros((5, 160))
gamma_160[0] =
gamma_160[1] =
gamma_160[2] =
gamma_160[3] =
gamma_160[4] =

gamma_320 = np.zeros((5, 320))
gamma_320[0] =
gamma_320[1] =
gamma_320[2] =
gamma_320[3] =
gamma_320[4] =

loss_10_min = np.min(loss_1, axis=0)
loss_10_max = np.max(loss_1, axis=0)
loss_10_ave = np.mean(loss_1, axis=0)
#
loss_20_min = np.min(loss_2, axis=0)
loss_20_max = np.max(loss_2, axis=0)
loss_20_ave = np.mean(loss_2, axis=0)

loss_40_min = np.min(loss_40, axis=0)
loss_40_max = np.max(loss_40, axis=0)
loss_40_ave = np.mean(loss_40, axis=0)

loss_80_min = np.min(loss_80, axis=0)
loss_80_max = np.max(loss_80, axis=0)
loss_80_ave = np.mean(loss_80, axis=0)

loss_160_min = np.min(loss_160, axis=0)
loss_160_max = np.max(loss_160, axis=0)
loss_160_ave = np.mean(loss_160, axis=0)

loss_320_min = np.min(loss_320, axis=0)
loss_320_max = np.max(loss_320, axis=0)
loss_320_ave = np.mean(loss_320, axis=0)

theta_10_min = np.min(theta_10, axis=0)
theta_10_max = np.max(theta_10, axis=0)
theta_10_ave = np.mean(theta_10, axis=0)
#
theta_20_min = np.min(theta_20, axis=0)
theta_20_max = np.max(theta_20, axis=0)
theta_20_ave = np.mean(theta_20, axis=0)

theta_40_min = np.min(theta_40, axis=0)
theta_40_max = np.max(theta_40, axis=0)
theta_40_ave = np.mean(theta_40, axis=0)

theta_80_min = np.min(theta_80, axis=0)
theta_80_max = np.max(theta_80, axis=0)
theta_80_ave = np.mean(theta_80, axis=0)

theta_160_min = np.min(theta_160, axis=0)
theta_160_max = np.max(theta_160, axis=0)
theta_160_ave = np.mean(theta_160, axis=0)

theta_320_min = np.min(theta_320, axis=0)
theta_320_max = np.max(theta_320, axis=0)
theta_320_ave = np.mean(theta_320, axis=0)

gamma_10_min = np.min(gamma_10, axis=0)
gamma_10_max = np.max(gamma_10, axis=0)
gamma_10_ave = np.mean(gamma_10, axis=0)
#
gamma_20_min = np.min(gamma_20, axis=0)
gamma_20_max = np.max(gamma_20, axis=0)
gamma_20_ave = np.mean(gamma_20, axis=0)

gamma_40_min = np.min(gamma_40, axis=0)
gamma_40_max = np.max(gamma_40, axis=0)
gamma_40_ave = np.mean(gamma_40, axis=0)

gamma_80_min = np.min(gamma_80, axis=0)
gamma_80_max = np.max(gamma_80, axis=0)
gamma_80_ave = np.mean(gamma_80, axis=0)

gamma_160_min = np.min(gamma_160, axis=0)
gamma_160_max = np.max(gamma_160, axis=0)
gamma_160_ave = np.mean(gamma_160, axis=0)

gamma_320_min = np.min(gamma_320, axis=0)
gamma_320_max = np.max(gamma_320, axis=0)
gamma_320_ave = np.mean(gamma_320, axis=0)

plt.style.use(['science', 'ieee', 'grid'])

plt.figure(dpi=800)
plt.plot(loss_320_ave, label='320 Layers', ls='-', color='gray', lw=0.7)
plt.fill_between(range(len(loss_320_ave)), loss_320_min, loss_320_max, color='gray', alpha=0.2, linewidth=0)
plt.plot(loss_160_ave, label='160 Layers', ls='-', color='purple', lw=0.7)
plt.fill_between(range(len(loss_160_ave)), loss_160_min, loss_160_max, color='purple', alpha=0.2, linewidth=0)
plt.plot(loss_80_ave, label='80 Layers', ls='-', color='orange', lw=0.7)
plt.fill_between(range(len(loss_80_ave)), loss_80_min, loss_80_max, color='orange', alpha=0.2, linewidth=0)
plt.plot(loss_40_ave, label='40 Layers', ls='-', color='green', lw=0.7)
plt.fill_between(range(len(loss_40_ave)), loss_40_min, loss_40_max, color='green', alpha=0.2, linewidth=0)
plt.plot(loss_20_ave, label='20 Layers', ls='-', color='blue', lw=0.7)
plt.fill_between(range(len(loss_20_ave)), loss_20_min, loss_20_max, color='blue', alpha=0.2, linewidth=0)
plt.plot(loss_10_ave, label='10 Layers', ls='-', color='red', lw=0.7)
plt.fill_between(range(len(loss_10_ave)), loss_10_min, loss_10_max, color='red', alpha=0.2, linewidth=0)
plt.yscale('log')
plt.xlabel('Batch (Each Batch for 10 Samples)')
plt.ylabel('Loss')
plt.title('Training loss varying epochs')
plt.legend(prop = {'size':6})
plt.savefig('../Test/Figures/trainStatic/loss.pdf')
plt.show()
plt.close()

# fitted_theta = [ 0.0045142 , -0.00281195, -0.00721875, -0.00887789, -0.00796106,
#        -0.00463994,  0.00091376,  0.00852836,  0.01803216,  0.02925348,
#         0.04202063,  0.05616191,  0.07150563,  0.08788011,  0.10511364,
#         0.12303455,  0.14147113,  0.1602517 ,  0.17920456,  0.19815803,
#         0.21694041,  0.23538002,  0.25330516,  0.27054413,  0.28692526,
#         0.30227685,  0.3164272 ,  0.32920463,  0.34043744,  0.34995395,
#         0.35758246,  0.36315129,  0.36648873,  0.3674231 ,  0.36578271,
#         0.36139587,  0.35409089,  0.34369607,  0.33003972,  0.31295016]

plt.figure(dpi=800)
plt.plot(np.arange(320)*0.31645/100, theta_320_ave, label='320 Layers', ls='-', color='gray')
plt.fill_between(np.arange(320)*0.31645/100, theta_320_min, theta_320_max, color='gray', alpha=0.4, linewidth=0)
plt.plot(np.arange(160)*0.6329/100, theta_160_ave, label='160 Layers', ls='-', color='purple')
plt.fill_between(np.arange(160)*0.6329/100, theta_160_min, theta_160_max, color='purple', alpha=0.4, linewidth=0)
plt.plot(np.arange(80)*1.2658/100, theta_80_ave, label='80 Layers', ls='-', color='blue')
plt.fill_between(np.arange(80)*1.2658/100, theta_80_min, theta_80_max, color='blue', alpha=0.4, linewidth=0)
plt.plot((np.arange(40))*2.5641/100, theta_40_ave, label='40 Layers', ls='-', color='orange')
plt.fill_between(np.arange(40)*2.5641/100, theta_40_min, theta_40_max, color='orange', alpha=0.4, linewidth=0)
plt.plot(np.arange(20)*5.2632/100, theta_20_ave, label='20 Layers', ls='-', color='green')
plt.fill_between(np.arange(20)*5.2632/100, theta_20_min, theta_20_max, color='green', alpha=0.4, linewidth=0)
plt.plot(np.arange(10)*10.5264/100, theta_10_ave, label='10 Layers', ls='-', color='red')
plt.fill_between(np.arange(10)*10.5264/100, theta_10_min, theta_10_max, color='red', alpha=0.4, linewidth=0)

plt.xlabel('Process of Layers ($k$/K)')
plt.ylabel('$\\Delta{\\theta}$')
plt.title('Offset of Threshold')
plt.grid(axis='x')
plt.legend(prop = {'size':6})
plt.savefig('../Test/Figures/trainStatic/theta_process.pdf')
plt.show()
plt.close()

max_iter = 320

plt.figure(dpi=800, figsize=(5,2))
plt.plot(np.arange(320)+max_iter-320, theta_320_ave, label='320 Layers', ls='-', color='gray', lw=0.9)
plt.fill_between(np.arange(320)+max_iter-320, theta_320_min, theta_320_max, color='gray', alpha=0.2, linewidth=0)
plt.plot(np.arange(160)+max_iter-160, theta_160_ave, label='160 Layers', ls='-', color='purple', lw=0.9)
plt.axvline(x=max_iter-160, ls='-.', color='purple')
plt.fill_between(np.arange(160)+max_iter-160, theta_160_min, theta_160_max, color='purple', alpha=0.2, linewidth=0)
plt.plot(np.arange(80)+max_iter-80, theta_80_ave, label='80 Layers', ls='-', color='orange', lw=0.9)
plt.axvline(x=max_iter-80, ls='-.', color='orange')
plt.fill_between(np.arange(80)+max_iter-80, theta_80_min, theta_80_max, color='orange', alpha=0.2, linewidth=0)
plt.plot(np.arange(40)+max_iter-40, theta_40_ave, label='40 Layers', ls='-', color='green', lw=0.9)
plt.axvline(x=max_iter-40, ls='-.', color='green')
plt.fill_between(np.arange(40)+max_iter-40, theta_40_min, theta_40_max, color='green', alpha=0.2, linewidth=0)
plt.plot(np.arange(20)+max_iter-20, theta_20_ave, label='20 Layers', ls='-', color='blue', lw=0.9)
plt.axvline(x=max_iter-20, ls='-.', color='blue')
plt.fill_between(np.arange(20)+max_iter-20, theta_20_min, theta_20_max, color='blue', alpha=0.2, linewidth=0)
plt.plot(np.arange(10)+max_iter-10, theta_10_ave, label='10 Layers', ls='-', color='red', lw=0.9)
plt.axvline(x=max_iter-10, ls='-.', color='red')
plt.fill_between(np.arange(10)+max_iter-10, theta_10_min, theta_10_max, color='red', alpha=0.2, linewidth=0)

# plt.plot(np.arange(40), np.zeros(40), ls=':', color='black', lw=1.5)
# plt.plot(np.arange(40)+40, fitted_theta, label='Fitted Threshold', ls=':', color='black', lw=1.5)

plt.xlabel('Layers ($k$)')
plt.ylabel('$\\Delta{\\theta}$')
plt.title('Offset of Threshold')
plt.grid(axis='x')
plt.legend(prop = {'size':6}, loc='upper left')
plt.savefig('../Test/Figures/trainStatic/theta.pdf')
plt.show()
plt.close()

# fitted_gamma = [ 0.00531127,  0.0101444 ,  0.0123697 ,  0.01213941,  0.00960579,
#         0.00492106, -0.00176253, -0.01029274, -0.02051734, -0.03228408,
#        -0.04544072, -0.05983503, -0.07531475, -0.09172767, -0.10892152,
#        -0.12674408, -0.14504311, -0.16366635, -0.18246159, -0.20127656,
#        -0.21995904, -0.23835678, -0.25631755, -0.2736891 , -0.2903192 ,
#        -0.3060556 , -0.32074606, -0.33423835, -0.34638022, -0.35701944,
#        -0.36600377, -0.37318096, -0.37839877, -0.38150497, -0.38234731,
#        -0.38077356, -0.37663147, -0.36976881, -0.36003334, -0.34727281]

plt.figure(dpi=800)
plt.plot(np.arange(320)*0.31645/100, gamma_320_ave, label='320 Layers', ls='-', color='gray')
plt.fill_between(np.arange(320)*0.31645/100, gamma_320_min, gamma_320_max, color='gray', alpha=0.4, linewidth=0)
plt.plot(np.arange(160)*0.6329/100, gamma_160_ave, label='160 Layers', ls='-', color='purple')
plt.fill_between(np.arange(160)*0.6329/100, gamma_160_min, gamma_160_max, color='purple', alpha=0.4, linewidth=0)
plt.plot(np.arange(80)*1.2658/100, gamma_80_ave, label='80 Layers', ls='-', color='blue')
plt.fill_between(np.arange(80)*1.2658/100, gamma_80_min, gamma_80_max, color='blue', alpha=0.4, linewidth=0)
plt.plot(np.arange(40)*2.5641/100, gamma_40_ave, label='40 Layers', ls='-', color='orange')
plt.fill_between(np.arange(40)*2.5641/100, gamma_40_min, gamma_40_max, color='orange', alpha=0.4, linewidth=0)
plt.plot(np.arange(20)*5.2632/100, gamma_20_ave, label='20 Layers', ls='-', color='green')
plt.fill_between(np.arange(20)*5.2632/100, gamma_20_min, gamma_20_max, color='green', alpha=0.4, linewidth=0)
plt.plot(np.arange(10)*10.5264/100, gamma_10_ave, label='10 Layers', ls='-', color='red')
plt.fill_between(np.arange(10)*10.5264/100, gamma_10_min, gamma_10_max, color='red', alpha=0.4, linewidth=0)

plt.xlabel('Process of Layers ($k$/K)')
plt.ylabel('$\\Delta{\\gamma}$')
plt.title('Offset of Step Size')
plt.grid(axis='x')
plt.legend(prop = {'size':6})
plt.savefig('../Test/Figures/trainStatic/gamma_process.pdf')
plt.show()
plt.close()

plt.figure(dpi=800, figsize=(5,2))
plt.plot(np.arange(320)+max_iter-320, gamma_320_ave, label='320 Layers', ls='-', color='gray', lw=0.9)
plt.fill_between(np.arange(320)+max_iter-320, gamma_320_min, gamma_320_max, color='gray', alpha=0.2, linewidth=0)
plt.plot(np.arange(160)+max_iter-160, gamma_160_ave, label='160 Layers', ls='-', color='purple', lw=0.9)
plt.axvline(x=max_iter-160, ls='-.', color='purple')
plt.fill_between(np.arange(160)+max_iter-160, gamma_160_min, gamma_160_max, color='purple', alpha=0.2, linewidth=0)
plt.plot(np.arange(80)+max_iter-80, gamma_80_ave, label='80 Layers', ls='-', color='orange', lw=0.9)
plt.axvline(x=max_iter-80, ls='-.', color='orange')
plt.fill_between(np.arange(80)+max_iter-80, gamma_80_min, gamma_80_max, color='orange', alpha=0.2, linewidth=0)
plt.plot(np.arange(40)+max_iter-40, gamma_40_ave, label='40 Layers', ls='-', color='green', lw=0.9)
plt.axvline(x=max_iter-40, ls='-.', color='green')
plt.fill_between(np.arange(40)+max_iter-40, gamma_40_min, gamma_40_max, color='green', alpha=0.2, linewidth=0)
plt.plot(np.arange(20)+max_iter-20, gamma_20_ave, label='20 Layers', ls='-', color='blue', lw=0.9)
plt.axvline(x=max_iter-20, ls='-.', color='blue')
plt.fill_between(np.arange(20)+max_iter-20, gamma_20_min, gamma_20_max, color='blue', alpha=0.2, linewidth=0)
plt.plot(np.arange(10)+max_iter-10, gamma_10_ave, label='10 Layers', ls='-', color='red', lw=0.9)
plt.axvline(x=max_iter-10, ls='-.', color='red')
plt.fill_between(np.arange(10)+max_iter-10, gamma_10_min, gamma_10_max, color='red', alpha=0.2, linewidth=0)

# plt.plot(np.arange(40), np.zeros(40), ls=':', color='black', lw=1.5)
# plt.plot(np.arange(40)+40, fitted_gamma, label='Fitted Step Size', ls=':', color='black', lw=1.5)
# plt.xscale('log')
plt.xlabel('Layers ($k$)')
plt.ylabel('$\\Delta{\\gamma}$')
plt.title('Offset of Step Size')
plt.grid(axis='x')
plt.legend(prop = {'size':6}, loc='upper left')
plt.savefig('../Test/Figures/trainStatic/gamma.pdf')
plt.show()
plt.close()


lambda_320_ave = (1+theta_320_ave) / (1+gamma_320_ave)
lambda_320_min = (1+theta_320_min) / (1+gamma_320_min)
lambda_320_max = (1+theta_320_max) / (1+gamma_320_max)
lambda_160_ave = (1+theta_160_ave) / (1+gamma_160_ave)
lambda_160_min = (1+theta_160_min) / (1+gamma_160_min)
lambda_160_max = (1+theta_160_max) / (1+gamma_160_max)
lambda_80_ave = (1+theta_80_ave) / (1+gamma_80_ave)
lambda_80_min = (1+theta_80_min) / (1+gamma_80_min)
lambda_80_max = (1+theta_80_max) / (1+gamma_80_max)
lambda_40_ave = (1+theta_40_ave) / (1+gamma_40_ave)
lambda_40_min = (1+theta_40_min) / (1+gamma_40_min)
lambda_40_max = (1+theta_40_max) / (1+gamma_40_max)
lambda_20_ave = (1+theta_20_ave) / (1+gamma_20_ave)
lambda_20_min = (1+theta_20_min) / (1+gamma_20_min)
lambda_20_max = (1+theta_20_max) / (1+gamma_20_max)
lambda_10_ave = (1+theta_10_ave) / (1+gamma_10_ave)
lambda_10_min = (1+theta_10_min) / (1+gamma_10_min)
lambda_10_max = (1+theta_10_max) / (1+gamma_10_max)

plt.figure(dpi=800, figsize=(5,2))
plt.plot(np.arange(320)+max_iter-320, lambda_320_ave, label='320 Layers', ls='-', color='gray', lw=0.9)
plt.fill_between(np.arange(320)+max_iter-320, lambda_320_min, lambda_320_max, color='gray', alpha=0.2, linewidth=0)
plt.plot(np.arange(160)+max_iter-160, lambda_160_ave, label='160 Layers', ls='-', color='purple', lw=0.9)
plt.axvline(x=max_iter-160, ls='-.', color='purple')
plt.fill_between(np.arange(160)+max_iter-160, lambda_160_min, lambda_160_max, color='purple', alpha=0.2, linewidth=0)
plt.plot(np.arange(80)+max_iter-80, lambda_80_ave, label='80 Layers', ls='-', color='orange', lw=0.9)
plt.axvline(x=max_iter-80, ls='-.', color='orange')
plt.fill_between(np.arange(80)+max_iter-80, lambda_80_min, lambda_80_max, color='orange', alpha=0.2, linewidth=0)
plt.plot(np.arange(40)+max_iter-40, lambda_40_ave, label='40 Layers', ls='-', color='green', lw=0.9)
plt.axvline(x=max_iter-40, ls='-.', color='green')
plt.fill_between(np.arange(40)+max_iter-40, lambda_40_min, lambda_40_max, color='green', alpha=0.2, linewidth=0)
plt.plot(np.arange(20)+max_iter-20, lambda_20_ave, label='20 Layers', ls='-', color='blue', lw=0.9)
plt.axvline(x=max_iter-20, ls='-.', color='blue')
plt.fill_between(np.arange(20)+max_iter-20, lambda_20_min, lambda_20_max, color='blue', alpha=0.2, linewidth=0)
plt.plot(np.arange(10)+max_iter-10, lambda_10_ave, label='10 Layers', ls='-', color='red', lw=0.9)
plt.axvline(x=max_iter-10, ls='-.', color='red')
plt.fill_between(np.arange(10)+max_iter-10, lambda_10_min, lambda_10_max, color='red', alpha=0.2, linewidth=0)

# plt.plot(np.arange(40), np.zeros(40), ls=':', color='black', lw=1.5)
# plt.plot(np.arange(40)+40, fitted_gamma, label='Fitted Step Size', ls=':', color='black', lw=1.5)
# plt.xscale('log')
plt.xlabel('Layers ($k$)')
plt.ylabel('$\\Delta{\\lambda}$')
plt.title('Offset of Sparse Regularization')
plt.grid(axis='x')
plt.legend(prop = {'size':6}, loc='upper left')
plt.savefig('../Test/Figures/trainStatic/Regularization.pdf')
plt.show()
plt.close()
