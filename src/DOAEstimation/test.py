#  Copyright (c) 2024. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
#  Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
#  Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
#  Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
#  Vestibulum commodo. Ut rhoncus gravida arcu.

import torch
from proposedMethods import proposedMethods
from functions import test_proposed, DatasetGeneration_sample
from __init__ import args_doa, args_unfolding_doa
args = args_doa()
args_unfolding = args_unfolding_doa()
import numpy as np
import matplotlib.pyplot as plt

if __name__ == '__main__':
    th = np.zeros((5, 80))
    th[0] = [-0.18604262173175812, -0.1919921487569809, -0.18293455243110657, -0.19816017150878906, -0.1957857310771942, -0.17623718082904816, -0.17901276051998138, -0.19734832644462585, -0.18773013353347778, -0.20734159648418427, -0.1909613013267517, -0.18583844602108002, -0.19178445637226105, -0.19439475238323212, -0.18616674840450287, -0.20512542128562927, -0.19151175022125244, -0.1777062565088272, -0.19449403882026672, -0.19613710045814514, -0.17848633229732513, -0.17451773583889008, -0.18027229607105255, -0.19857820868492126, -0.1993836611509323, -0.2021426111459732, -0.18794646859169006, -0.1877194046974182, -0.17981603741645813, -0.18050603568553925, -0.1911976933479309, -0.18790507316589355, -0.18532423675060272, -0.18823832273483276, -0.2065640091896057, -0.19436144828796387, -0.16682790219783783, -0.19215357303619385, -0.18782828748226166, -0.1925746202468872, -0.19718755781650543, -0.17942121624946594, -0.18524853885173798, -0.18248507380485535, -0.18007542192935944, -0.1757294088602066, -0.17816734313964844, -0.17178264260292053, -0.17267057299613953, -0.1558844894170761, -0.16893412172794342, -0.13082152605056763, -0.12877248227596283, -0.11973803490400314, -0.08630604296922684, -0.07552225887775421, -0.045473452657461166, -0.011471772566437721, -0.0183432474732399, 0.043634649366140366, 0.09982745349407196, 0.12208323180675507, 0.17584584653377533, 0.24228914082050323, 0.3595435917377472, 0.43809399008750916, 0.4329639673233032, 0.41018402576446533, 0.3727988004684448, 0.36471086740493774, 0.3469427227973938, 0.3119238615036011, 0.31373101472854614, 0.30536845326423645, 0.304596871137619, 0.29797065258026123, 0.29275721311569214, 0.283242791891098, 0.2842043340206146, 0.2970195412635803]
    th[1] = [-0.17225182056427002, -0.1775742620229721, -0.1858307272195816, -0.18125881254673004, -0.17764276266098022, -0.17256101965904236, -0.18743307888507843, -0.18159067630767822, -0.16935549676418304, -0.1588754951953888, -0.18121027946472168, -0.17866718769073486, -0.17416729032993317, -0.17044542729854584, -0.14762666821479797, -0.18227583169937134, -0.16575253009796143, -0.18258367478847504, -0.16700272262096405, -0.17634011805057526, -0.17706245183944702, -0.17474786937236786, -0.16319048404693604, -0.1920497715473175, -0.19968704879283905, -0.17746055126190186, -0.15726029872894287, -0.16132009029388428, -0.16196341812610626, -0.1848360151052475, -0.17788350582122803, -0.18015056848526, -0.18374735116958618, -0.17550790309906006, -0.17730401456356049, -0.16592085361480713, -0.1766771525144577, -0.18357445299625397, -0.17132540047168732, -0.17571356892585754, -0.16132783889770508, -0.190158411860466, -0.16961373388767242, -0.15044578909873962, -0.1526954621076584, -0.15447786450386047, -0.15888184309005737, -0.15947197377681732, -0.1454782783985138, -0.1436566561460495, -0.1298460066318512, -0.13955335319042206, -0.1095542311668396, -0.08735119551420212, -0.057454753667116165, -0.0618889220058918, -0.027455268427729607, 0.0036658139433711767, 0.036305397748947144, 0.09566887468099594, 0.10889759659767151, 0.16068319976329803, 0.20342862606048584, 0.25660690665245056, 0.33410415053367615, 0.4117414057254791, 0.42140769958496094, 0.41371050477027893, 0.3932892084121704, 0.36472177505493164, 0.3629922568798065, 0.31982332468032837, 0.33145707845687866, 0.3087787926197052, 0.3141173720359802, 0.2853463888168335, 0.3040415942668915, 0.28934624791145325, 0.28810685873031616, 0.2904488444328308]
    th[2] = [-0.1934065818786621, -0.1863154172897339, -0.1693195402622223, -0.1922699511051178, -0.17324016988277435, -0.18577322363853455, -0.1855662763118744, -0.17776042222976685, -0.19057321548461914, -0.19500303268432617, -0.18742994964122772, -0.18533895909786224, -0.19951513409614563, -0.19057607650756836, -0.19867072999477386, -0.17672674357891083, -0.19216959178447723, -0.1908837854862213, -0.19317740201950073, -0.19918708503246307, -0.18996013700962067, -0.18456114828586578, -0.18437904119491577, -0.17694857716560364, -0.1800057291984558, -0.2006910890340805, -0.19921709597110748, -0.1642855852842331, -0.17500963807106018, -0.17523999512195587, -0.17945614457130432, -0.1791176050901413, -0.18485498428344727, -0.1663539856672287, -0.19178849458694458, -0.17924264073371887, -0.169901505112648, -0.20090855658054352, -0.1778029054403305, -0.1774667501449585, -0.1888675093650818, -0.1904461681842804, -0.1587098389863968, -0.17558519542217255, -0.18647271394729614, -0.17310340702533722, -0.16368940472602844, -0.1593499630689621, -0.16267040371894836, -0.15154360234737396, -0.14949564635753632, -0.1326320320367813, -0.12459365278482437, -0.10886475443840027, -0.10042477399110794, -0.07802079617977142, -0.03213715925812721, -0.00016339636931661516, 0.008505535311996937, 0.05534350126981735, 0.08362610638141632, 0.1531621515750885, 0.2069673240184784, 0.24726639688014984, 0.33596527576446533, 0.430018812417984, 0.4351353049278259, 0.40186819434165955, 0.39248180389404297, 0.37535834312438965, 0.3424447476863861, 0.32697612047195435, 0.3150588870048523, 0.31582602858543396, 0.31743529438972473, 0.3032275438308716, 0.30533474683761597, 0.3035150468349457, 0.3002232015132904, 0.2855697572231293]
    th[3] = [-0.18381084501743317, -0.1824156641960144, -0.17388804256916046, -0.17567677795886993, -0.18672530353069305, -0.1774899661540985, -0.19562378525733948, -0.18147781491279602, -0.1713634431362152, -0.1539802998304367, -0.19016888737678528, -0.17876063287258148, -0.17733144760131836, -0.19951000809669495, -0.16489727795124054, -0.1836908906698227, -0.2013971209526062, -0.1917513608932495, -0.1932293325662613, -0.17699262499809265, -0.18746213614940643, -0.18979252874851227, -0.1786973625421524, -0.1736733317375183, -0.19715537130832672, -0.20200839638710022, -0.18966031074523926, -0.1872745305299759, -0.182979553937912, -0.17614567279815674, -0.1667872965335846, -0.18222177028656006, -0.17316555976867676, -0.1881062388420105, -0.1932990401983261, -0.1677449494600296, -0.1763974279165268, -0.19845689833164215, -0.1722422093153, -0.1926187127828598, -0.17804932594299316, -0.18372909724712372, -0.17081116139888763, -0.16149534285068512, -0.18561547994613647, -0.1585744172334671, -0.14390403032302856, -0.16327287256717682, -0.13417275249958038, -0.16431811451911926, -0.14081016182899475, -0.12000162154436111, -0.11381622403860092, -0.10418614745140076, -0.09109718352556229, -0.058773770928382874, -0.05361514165997505, -0.006372672971338034, 0.03243071213364601, 0.06389170140028, 0.11263758689165115, 0.15644249320030212, 0.2042302042245865, 0.24374158680438995, 0.330940842628479, 0.4230906367301941, 0.4478718936443329, 0.4237610101699829, 0.39979782700538635, 0.37430083751678467, 0.34672755002975464, 0.31838327646255493, 0.30242806673049927, 0.31979987025260925, 0.309368371963501, 0.30126050114631653, 0.3060683310031891, 0.3071061074733734, 0.2782072424888611, 0.2882823348045349]
    th[4] = [-0.19127418100833893, -0.1812707930803299, -0.17030069231987, -0.18170428276062012, -0.18684029579162598, -0.183955118060112, -0.16845203936100006, -0.17802095413208008, -0.1728910207748413, -0.1419619768857956, -0.17976509034633636, -0.17485539615154266, -0.16294948756694794, -0.19058862328529358, -0.1806001216173172, -0.1950211524963379, -0.18522901833057404, -0.1749693900346756, -0.17433728277683258, -0.18067577481269836, -0.1792149692773819, -0.1939576417207718, -0.17782890796661377, -0.18620236217975616, -0.16819921135902405, -0.16882003843784332, -0.1669635772705078, -0.18515312671661377, -0.18194764852523804, -0.18492989242076874, -0.16458454728126526, -0.18083786964416504, -0.1782258003950119, -0.1832016110420227, -0.1768019199371338, -0.17017221450805664, -0.1728755086660385, -0.17805573344230652, -0.1632021963596344, -0.18274275958538055, -0.17383001744747162, -0.1815624237060547, -0.17969205975532532, -0.18037401139736176, -0.1757367104291916, -0.15901367366313934, -0.17023742198944092, -0.1634262204170227, -0.1630697101354599, -0.151400625705719, -0.1434522569179535, -0.12488166987895966, -0.1194770410656929, -0.10561385005712509, -0.0832144245505333, -0.047197986394166946, -0.038163356482982635, -0.02251429110765457, 0.028024522587656975, 0.050776563584804535, 0.10411981493234634, 0.13184159994125366, 0.1921292394399643, 0.24025243520736694, 0.33284303545951843, 0.44687533378601074, 0.43493545055389404, 0.4229522943496704, 0.39409029483795166, 0.3784444034099579, 0.3405989408493042, 0.33110952377319336, 0.317535400390625, 0.2890627980232239, 0.29297834634780884, 0.3033083379268646, 0.30525603890419006, 0.277182400226593, 0.30376631021499634, 0.2899686396121979]

    gm = np.zeros((5, 80))
    gm[0] =  [-0.1959681659936905, -0.1879746913909912, -0.1768685281276703, -0.18538139760494232, -0.17733171582221985, -0.1912451535463333, -0.19570447504520416, -0.18243540823459625, -0.19494028389453888, -0.1904740333557129, -0.1888529658317566, -0.20245467126369476, -0.1973475068807602, -0.1686895191669464, -0.17939548194408417, -0.1875913292169571, -0.19074590504169464, -0.1716458946466446, -0.18468540906906128, -0.1602030098438263, -0.18725836277008057, -0.19025717675685883, -0.18475140631198883, -0.1869947463274002, -0.17272691428661346, -0.17507266998291016, -0.18709129095077515, -0.19223067164421082, -0.1898336112499237, -0.17249557375907898, -0.19848480820655823, -0.19865673780441284, -0.19922761619091034, -0.1826377809047699, -0.19010606408119202, -0.19745038449764252, -0.19310754537582397, -0.1906614601612091, -0.19178806245326996, -0.21117322146892548, -0.2144135981798172, -0.2095249444246292, -0.23757627606391907, -0.27520519495010376, -0.2728212773799896, -0.286708801984787, -0.3266681134700775, -0.3414127826690674, -0.3758986294269562, -0.38133326172828674, -0.3918530344963074, -0.3830132484436035, -0.4436633884906769, -0.4369567632675171, -0.4581478238105774, -0.4712841510772705, -0.4777507483959198, -0.48564040660858154, -0.4709389805793762, -0.4527684152126312, -0.46446913480758667, -0.46790382266044617, -0.46160081028938293, -0.4343988597393036, -0.43520814180374146, -0.43874773383140564, -0.4367421865463257, -0.40834519267082214, -0.40784648060798645, -0.3910108506679535, -0.37387722730636597, -0.3535686433315277, -0.35126736760139465, -0.3429497480392456, -0.35573381185531616, -0.3516561985015869, -0.35380226373672485, -0.35849952697753906, -0.35397574305534363, -0.3332105875015259]
    gm[1] = [-0.16999496519565582, -0.15816621482372284, -0.15750449895858765, -0.17351821064949036, -0.17746831476688385, -0.16715583205223083, -0.1596333384513855, -0.1570271998643875, -0.16223986446857452, -0.15707509219646454, -0.15808193385601044, -0.18349792063236237, -0.18170714378356934, -0.1663007289171219, -0.17716459929943085, -0.1668766736984253, -0.16362856328487396, -0.1870567351579666, -0.17326223850250244, -0.16033270955085754, -0.16832122206687927, -0.17122609913349152, -0.15743650496006012, -0.16048555076122284, -0.17249977588653564, -0.1656952202320099, -0.18616105616092682, -0.17675921320915222, -0.19829140603542328, -0.17155152559280396, -0.17615240812301636, -0.1876387596130371, -0.17691032588481903, -0.18847167491912842, -0.1670369654893875, -0.1701698899269104, -0.1764417588710785, -0.18732143938541412, -0.16614428162574768, -0.16241200268268585, -0.1945159137248993, -0.18925392627716064, -0.22961531579494476, -0.23362505435943604, -0.2450631558895111, -0.2655394673347473, -0.32257670164108276, -0.3057730197906494, -0.3379620611667633, -0.3543335497379303, -0.349460244178772, -0.39326682686805725, -0.3968534469604492, -0.42965391278266907, -0.4268229305744171, -0.44134721159935, -0.4451136291027069, -0.45019084215164185, -0.4652348458766937, -0.4730239808559418, -0.4463958442211151, -0.4647035598754883, -0.4621068239212036, -0.430169939994812, -0.4190273880958557, -0.4102727472782135, -0.4176086485385895, -0.4116632044315338, -0.4016300439834595, -0.37433427572250366, -0.3750934302806854, -0.36415672302246094, -0.37079882621765137, -0.34235429763793945, -0.3506513833999634, -0.3581395149230957, -0.3425546884536743, -0.35765695571899414, -0.34679651260375977, -0.344723641872406]
    gm[2] = [-0.17727486789226532, -0.17214538156986237, -0.1933109611272812, -0.1744292676448822, -0.1731974333524704, -0.1845778077840805, -0.1934005618095398, -0.16373710334300995, -0.18878214061260223, -0.18305443227291107, -0.1905941218137741, -0.1726437211036682, -0.193141371011734, -0.17103271186351776, -0.1852945238351822, -0.1875401735305786, -0.1652880162000656, -0.1860109120607376, -0.17124654352664948, -0.166838601231575, -0.1631195843219757, -0.1802321821451187, -0.1661389023065567, -0.1622639298439026, -0.17225371301174164, -0.16579578816890717, -0.1775188446044922, -0.19403761625289917, -0.20202460885047913, -0.1865813136100769, -0.1709192395210266, -0.17879819869995117, -0.17457304894924164, -0.1783323884010315, -0.17341096699237823, -0.20397932827472687, -0.2041412740945816, -0.18010954558849335, -0.18728312849998474, -0.19293589890003204, -0.21401135623455048, -0.20908190310001373, -0.2259928435087204, -0.24560301005840302, -0.25034159421920776, -0.293536901473999, -0.3006138801574707, -0.33301055431365967, -0.33870628476142883, -0.3745165467262268, -0.38029012084007263, -0.4131051003932953, -0.41486045718193054, -0.4302766025066376, -0.4417847692966461, -0.45201319456100464, -0.4637995958328247, -0.4657268524169922, -0.47480669617652893, -0.463604599237442, -0.4634297490119934, -0.46020233631134033, -0.474597305059433, -0.440890371799469, -0.432620108127594, -0.4232010841369629, -0.44887542724609375, -0.4179280698299408, -0.3820258378982544, -0.3883814811706543, -0.37488389015197754, -0.35268259048461914, -0.3469391167163849, -0.3377819061279297, -0.34999969601631165, -0.33463582396507263, -0.3522944152355194, -0.3563475012779236, -0.3472532033920288, -0.33514437079429626]
    gm[3] = [-0.18412865698337555, -0.18846917152404785, -0.16565948724746704, -0.17854373157024384, -0.1782670021057129, -0.17894454300403595, -0.18271797895431519, -0.16753029823303223, -0.17037759721279144, -0.1824990212917328, -0.18650424480438232, -0.17186881601810455, -0.16003559529781342, -0.15855103731155396, -0.16892333328723907, -0.1930844485759735, -0.17666509747505188, -0.16776630282402039, -0.17413392663002014, -0.17567865550518036, -0.16778503358364105, -0.1679912656545639, -0.168040469288826, -0.17154626548290253, -0.17506776750087738, -0.18340300023555756, -0.18093091249465942, -0.1990097165107727, -0.17186875641345978, -0.18440310657024384, -0.18027152121067047, -0.1859900802373886, -0.15998080372810364, -0.19876962900161743, -0.17038656771183014, -0.19274412095546722, -0.17915977537631989, -0.2109154760837555, -0.19888100028038025, -0.1943574696779251, -0.2067810595035553, -0.20279884338378906, -0.23087193071842194, -0.2487279623746872, -0.26551908254623413, -0.2901398539543152, -0.30022597312927246, -0.3154161870479584, -0.3270050585269928, -0.3622783124446869, -0.3874407112598419, -0.38200652599334717, -0.41939258575439453, -0.42071327567100525, -0.44802653789520264, -0.43646788597106934, -0.4513886570930481, -0.45027661323547363, -0.44911375641822815, -0.4575439691543579, -0.45847252011299133, -0.4548432528972626, -0.4510810375213623, -0.4507080912590027, -0.4371260404586792, -0.4297357201576233, -0.40857234597206116, -0.42551589012145996, -0.4045344293117523, -0.38084676861763, -0.37443748116493225, -0.35472509264945984, -0.360964834690094, -0.34236466884613037, -0.34692201018333435, -0.3501169979572296, -0.3476373553276062, -0.3466213047504425, -0.3470027446746826, -0.34521669149398804]
    gm[4] = [-0.17485210299491882, -0.17510104179382324, -0.1768818348646164, -0.19007641077041626, -0.1704370528459549, -0.17022840678691864, -0.17070984840393066, -0.1690424531698227, -0.1855461448431015, -0.18343351781368256, -0.1754632145166397, -0.17861570417881012, -0.16668285429477692, -0.1719231754541397, -0.18730628490447998, -0.18221543729305267, -0.15668606758117676, -0.17608819901943207, -0.1722043752670288, -0.16232261061668396, -0.1727599948644638, -0.17193761467933655, -0.1857031285762787, -0.17129772901535034, -0.1732391119003296, -0.1803700476884842, -0.1749608963727951, -0.18022730946540833, -0.17170488834381104, -0.18396325409412384, -0.17806373536586761, -0.17523378133773804, -0.18031561374664307, -0.1938825249671936, -0.17913010716438293, -0.17540645599365234, -0.18932831287384033, -0.17082515358924866, -0.19134321808815002, -0.17892305552959442, -0.19033586978912354, -0.21669843792915344, -0.2145996391773224, -0.2302466332912445, -0.2665728032588959, -0.27445679903030396, -0.2957809567451477, -0.3132137060165405, -0.3296958804130554, -0.3350134491920471, -0.3636268377304077, -0.4036283791065216, -0.4107070863246918, -0.4172964096069336, -0.43188345432281494, -0.4438895285129547, -0.4739697277545929, -0.4514959752559662, -0.4476030468940735, -0.4607105851173401, -0.45933425426483154, -0.4631865918636322, -0.4276939928531647, -0.44053930044174194, -0.4471243619918823, -0.4362447261810303, -0.42772239446640015, -0.4100307822227478, -0.40543970465660095, -0.37889841198921204, -0.3866463601589203, -0.35042133927345276, -0.3539957106113434, -0.3577599823474884, -0.3551087975502014, -0.34583768248558044, -0.3464561402797699, -0.34230324625968933, -0.34203875064849854, -0.344394713640213]

    th_min = np.min(th, axis=0)
    th_max = np.max(th, axis=0)
    th_ave = np.mean(th, axis=0)

    gm_min = np.min(gm, axis=0)
    gm_max = np.max(gm, axis=0)
    gm_ave = np.mean(gm, axis=0)

    plt.style.use(['science', 'ieee', 'grid'])

    plt.figure(dpi=800)
    plt.plot(th_ave, label='80 Iterations', ls='-', color='orange', lw=0.7)
    plt.fill_between(range(len(th_ave)), th_min, th_max, color='orange', alpha=0.2, linewidth=0)
    plt.xlabel('Batch (Each Batch for 10 Samples)')
    plt.ylabel('$\\Delta \\theta$')
    plt.title('Offset of Threshold')
    plt.legend()
    # plt.savefig('../Test/Figures/trainStatic/loss.pdf')
    plt.show()
    # plt.close()

    plt.figure(dpi=800)
    plt.plot(gm_ave, label='80 Iterations', ls='-', color='orange', lw=0.7)
    plt.fill_between(range(len(th_ave)), gm_min, gm_max, color='orange', alpha=0.2, linewidth=0)
    plt.xlabel('Batch (Each Batch for 10 Samples)')
    plt.ylabel('$\\Delta \\gamma$')
    plt.title('Offset of Step Size')
    plt.legend()
    # plt.savefig('../Test/Figures/trainStatic/loss.pdf')
    plt.show()
