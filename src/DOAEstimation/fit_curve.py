#  Copyright (c) 2024. Lorem ipsum dolor sit amet, consectetur adipiscing elit.
#  Morbi non lorem porttitor neque feugiat blandit. Ut vitae ipsum eget quam lacinia accumsan.
#  Etiam sed turpis ac ipsum condimentum fringilla. Maecenas magna.
#  Proin dapibus sapien vel ante. Aliquam erat volutpat. Pellentesque sagittis ligula eget metus.
#  Vestibulum commodo. Ut rhoncus gravida arcu.

import numpy as np
import scipy.optimize as opt
import matplotlib.pyplot as plt

gamma =[-0.23375944, -0.22391358, -0.22965866, -0.24354127, -0.22545734,
                             -0.22275088, -0.2371711, -0.23148447, -0.2286394, -0.22949583,
                             -0.2254094, -0.23288502, -0.23440456, -0.22975829, -0.22923312,
                             -0.23090445, -0.23210564, -0.22688224, -0.23098882, -0.23364339,
                             -0.23433992, -0.23084986, -0.22774045, -0.23498956, -0.22242581,
                             -0.22933938, -0.22930836, -0.22775892, -0.23494966, -0.22693274,
                             -0.23023289, -0.22461929, -0.22735227, -0.22297318, -0.22662648,
                             -0.2312364, -0.23415934, -0.23120708, -0.22943232, -0.22623306,
                             -0.22493866, -0.22946753, -0.2329839, -0.23520374, -0.23191639,
                             -0.22709694, -0.23190705, -0.23453938, -0.22289771, -0.22944681,
                             -0.23066777, -0.22938346, -0.23112476, -0.23076117, -0.23343268,
                             -0.23904145, -0.23487003, -0.23204061, -0.23563412, -0.23241764,
                             -0.23257608, -0.23262743, -0.23549382, -0.23200029, -0.23306372,
                             -0.22863284, -0.22930254, -0.22649847, -0.23994506, -0.22980947,
                             -0.2378401, -0.23970763, -0.22757128, -0.23205535, -0.22794527,
                             -0.23553332, -0.23439741, -0.23463632, -0.23099701, -0.22776815,
                             -0.22577772, -0.21883818, -0.22870781, -0.23793651, -0.2292318,
                             -0.24034131, -0.23972072, -0.23283576, -0.23669474, -0.22792893,
                             -0.22690822, -0.23416484, -0.22801928, -0.22955013, -0.22187954,
                             -0.21772609, -0.22799042, -0.23377028, -0.23351531, -0.23219309,
                             -0.22924202, -0.22266502, -0.22852608, -0.22986691, -0.22945846,
                             -0.22458298, -0.21744826, -0.22745194, -0.2322256, -0.2227432,
                             -0.22685634, -0.22415929, -0.23311955, -0.23818025, -0.22451639,
                             -0.21141988, -0.23422206, -0.21824285, -0.22064822, -0.23138187,
                             -0.22386324, -0.22649344, -0.22442513, -0.22683788, -0.22534898,
                             -0.23005297, -0.22266294, -0.22856979, -0.2206577, -0.22933851,
                             -0.22336599, -0.22193779, -0.22972676, -0.2223047, -0.22717638,
                             -0.22578571, -0.22276276, -0.2301607, -0.22135986, -0.22536961,
                             -0.22815333, -0.22702385, -0.22938582, -0.23007481, -0.23681662,
                             -0.22984123, -0.22773721, -0.22489821, -0.23333934, -0.22303978,
                             -0.22536833, -0.22550904, -0.23257345, -0.22488502, -0.22635423,
                             -0.22188109, -0.21832319, -0.22883406, -0.22993714, -0.23124143,
                             -0.22842415, -0.22667419, -0.22190156, -0.22320426, -0.23193916,
                             -0.22981566, -0.23051731, -0.22569047, -0.23291776, -0.22856666,
                             -0.23551517, -0.23355092, -0.23121929, -0.2341044, -0.22932312,
                             -0.2256959, -0.23298853, -0.22948507, -0.23397719, -0.23532296,
                             -0.22885798, -0.23450633, -0.23495535, -0.23742698, -0.23344797,
                             -0.23676068, -0.2385143, -0.23814101, -0.22738544, -0.23808904,
                             -0.23680909, -0.2264124, -0.23350519, -0.23463556, -0.22997391,
                             -0.22670223, -0.22791932, -0.23633538, -0.23688476, -0.2414582,
                             -0.23910726, -0.22977116, -0.23195165, -0.24403608, -0.23014074,
                             -0.23737078, -0.22953144, -0.24531811, -0.2394115, -0.22913241,
                             -0.2440915, -0.23572013, -0.2369251, -0.24398925, -0.24079569,
                             -0.23834005, -0.24533909, -0.23596537, -0.24025776, -0.23412062,
                             -0.23411696, -0.24055111, -0.23823355, -0.2387242, -0.23035179,
                             -0.23784869, -0.23213845, -0.22979254, -0.24124766, -0.24316558,
                             -0.245344, -0.2347729, -0.23193106, -0.23516093, -0.2400885,
                             -0.23822463, -0.2271176, -0.23103485, -0.2390146, -0.2464976,
                             -0.23370407, -0.2450779, -0.23687356, -0.23755459, -0.24148645,
                             -0.23760196, -0.24333506, -0.22725784, -0.23691672, -0.23353779,
                             -0.23087974, -0.23640368, -0.2247491, -0.22871628, -0.23778332,
                             -0.22802003, -0.2310117, -0.22292987, -0.22634473, -0.21770264,
                             -0.21639564, -0.21651803, -0.1945452, -0.19536556, -0.18867429,
                             -0.19020157, -0.17159035, -0.16509451, -0.16045555, -0.14525905,
                             -0.12956436, -0.11727781, -0.09931937, -0.09400278, -0.07662413,
                             -0.05517146, -0.04365572, -0.02723957, -0.00434339, 0.02650045,
                             0.05430524, 0.09510594, 0.14043895, 0.19907033, 0.25949354,
                             0.32426717, 0.37779582, 0.42189286, 0.4305571, 0.42870138,
                             0.42686203, 0.41383536, 0.40739877, 0.39426507, 0.39257128,
                             0.38227726, 0.38069563, 0.36599194, 0.35497637, 0.35074444,
                             0.33746433, 0.33307388, 0.32407157, 0.30735927, 0.31007681,
                             0.2910127, 0.28318167, 0.28059166, 0.26776227, 0.28557762,
                             0.28404225, 0.2920879, 0.28207687, 0.27902683, 0.28598834,
                             0.28612096, 0.29346832, 0.30157026, 0.29415848, 0.30252116]

fit_layers = 320

# save as txt
# with open('weights.txt', 'w') as f:
#     for idd, item in enumerate(t):
#         f.write(str(idd) + '\t' + str(item) + '\n')


t = gamma

def target_func(x, a, b, c, d, e, f):
    return a*x**5 + b*x**4 + c*x**3 + d*x**2 + e*x + f

para, cov = opt.curve_fit(target_func, xdata=np.arange(fit_layers), ydata=t, maxfev=500000)

print(para)

y_fit = [target_func(a, *para) for a in np.arange(fit_layers)]

fixed_num = 640

fixed = [target_func(a, *para) for a in np.arange(fixed_num)/fixed_num*fit_layers]

plt.style.use(['science', 'ieee', 'grid'])

plt.plot(t, label='Trained weights')
plt.plot(y_fit, label='Fitted weights')
plt.plot(fixed, label='Fitted weights (fixed)')
plt.legend()
plt.show()
